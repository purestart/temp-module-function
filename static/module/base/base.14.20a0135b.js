webpackJsonpbase([14],{197:function(e,n,t){"use strict";function a(e){t(451),t(453)}Object.defineProperty(n,"__esModule",{value:!0});var s=t(263),r=t(455),i=t(208),o=a,l=i(s.a,r.a,!1,o,"data-v-72a630a6",null);n.default=l.exports},208:function(e,n){e.exports=function(e,n,t,a,s,r){var i,o=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(i=e,o=e.default);var p="function"==typeof o?o.options:o;n&&(p.render=n.render,p.staticRenderFns=n.staticRenderFns,p._compiled=!0),t&&(p.functional=!0),s&&(p._scopeId=s);var m;if(r?(m=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},p._ssrRegister=m):a&&(m=a),m){var c=p.functional,g=c?p.render:p.beforeCreate;c?(p._injectStyles=m,p.render=function(e,n){return m.call(n),g(e,n)}):p.beforeCreate=g?[].concat(g,m):[m]}return{esModule:i,exports:o,options:p}}},263:function(e,n,t){"use strict";var a=t(46);n.a={name:"messageTemplateAdd",data:function(){return{templateBread:"",listLoading:!1,tableKey:1,sceneCodes:[],isModify:!1,sendDebouce:!1,isJustSee:!1,checkList:["选中且禁用","复选框 A"],nameslist:[],seceneParam:"",contentMsg:"",tempalteShowText:"",messageTemplate:{sceneName:null,sceneCode:"",templateName:"",templateCode:"",seceneParam:null,content:"",status:1},rules:{sceneCode:[{required:!0,message:"请选择短信场景",trigger:"blur"}],seceneParam:[{required:!0,message:"请先选择短信场景",trigger:"blur"}],content:[{required:!0,message:"请填写模板内容",trigger:"blur"},{validator:function(e,n,t){if(n.length>500)return t(new Error("模板字符数最多500个"));t()},trigger:"blur"}]}}},methods:{handleClick:function(e,n){console.log(e,n)},seceneParamFunc:function(e){console.log(e),this.messageTemplate.content=this.messageTemplate.content+"{"+e.paramCode+"}"},sendMessage:function(){var e=this;this.sendDebouce=!0,this.$refs.messageTemplate.validate(function(n){if(n){if(null==e.messageTemplate.phone||void 0==e.messageTemplate.phone||""==e.messageTemplate.phone)return void e.error("请输入手机号");if(11!=e.messageTemplate.phone.length)return void e.error("手机号格式不正确");var t={mobile:e.messageTemplate.phone,content:e.messageTemplate.content};Object(a._11)(t).then(function(n){n.result?(e.success("发送测试短信成功"),e.contentMsg=n.msg):e.error(n.msg)}).catch(function(e){console.log(e)})}})},closeDialog:function(){this.dialogFormVisible=!1},submitForm:function(e,n){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var s=t.messageTemplate;delete s.seceneParam,n?(s.id=t.$route.query.id,Object(a._15)(s).then(function(e){e.result?(t.success("修改短信模板成功"),t.$store.commit("tagNav/removeTagNav",t.$route),t.$router.push("/sys/message/messageTemplate")):t.error(e.msg)}).catch(function(e){console.log(e)})):Object(a.r)(s).then(function(e){e.result?(t.success("创建短信模板成功"),t.$store.commit("tagNav/removeTagNav",t.$route),t.$router.push("/sys/message/messageTemplate")):t.error(e.msg)}).catch(function(e){console.log(e)})})},getInfo:function(){},querySmsScene:function(){var e=this,n={};this.$route.query.sceneCode&&(n={sceneCode:this.$route.query.sceneCode}),Object(a.Y)(n).then(function(n){if(e.sceneCodes=n.data.data.filter(function(e){return 1==e.status}),e.$route.query.isModify){var t=JSON.parse(localStorage.getItem("detailTemplate"));e.messageTemplate.sceneCode=t.sceneCode;var a=n.data.data.filter(function(e){return e.sceneCode==t.sceneCode});e.messageTemplate.seceneParam=a&&a[0]&&a[0].paramList;var s=a&&a[0]&&a[0].paramList,r="",i="";if(s){for(var o=0;o<s.length;o++)r+=s[o].paramName+":{",r+=s[o].paramCode+"},",i+=s[o].paramName+":",i+=s[o].sample;e.tempalteShowText=i,e.messageTemplate.content=t.content}}})},out:function(){this.$store.commit("tagNav/removeTagNav",this.$route),this.$router.push("/sys/message/messageTemplate")},templateTextareaFunc:function(){var e=/\{(.+?)\}/g,n=this.messageTemplate.content,t=n.match(e);console.log(t,1);var a=(this.tempalteShowText,[]);if(t){for(var s=0;s<t.length;s++){var r=t[s].slice(1,t[s].length-1);a.push(r)}var i=[];console.log(i)}this.messageTemplate.seceneParam},templateFunc:function(e){console.log(e);var n=this.sceneCodes.filter(function(n){return n.sceneCode==e});this.messageTemplate.seceneParam=n&&n[0]&&n[0].paramList,console.log(n[0]),this.messageTemplate.sceneName=n&&n[0]&&n[0].sceneName,this.messageTemplate.sceneCode=n&&n[0]&&n[0].sceneCode,this.messageTemplate.templateName=n&&n[0]&&n[0].sceneName,this.messageTemplate.templateCode=n&&n[0]&&n[0].sceneCode;for(var t=n&&n[0]&&n[0].paramList,a="",s="",r=0;r<t.length;r++)a+=t[r].paramName+":{",a+=t[r].paramCode+"}",s+=t[r].paramName+":",s+=t[r].sample;this.messageTemplate.content=a,this.tempalteShowText=s},unique:function(e){for(var n=[e[0]],t=1;t<e.length;t++)-1==n.indexOf(e[t])&&n.push(e[t]);return n},addContact:function(){this.$refs;this.$refs.tableDataRef,this.dialogFormVisible=!0}},created:function(){this.isModify="true"==this.$route.query.isModify||1==this.$route.query.isModify,this.isJustSee="true"==this.$route.query.isJustSee||1==this.$route.query.isJustSee,this.isModify&&(this.getInfo(),this.isJustSee||(this.templateBread="编辑短信模板")),this.isModify||(this.templateBread="新建短信模板"),this.querySmsScene()}}},451:function(e,n,t){var a=t(452);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t(167)("3bcbf1e0",a,!0,{})},452:function(e,n,t){n=e.exports=t(166)(!0),n.push([e.i,"\n.page-justsee-messagetml-edit .marginTop8 {\n  margin-top: 8px;\n}\n.page-justsee-messagetml-edit .width490 {\n  width: 490px;\n}\n.page-justsee-messagetml-edit .el-form-item__label {\n  font-size: 12px;\n  line-height: 40px;\n}\n.page-justsee-messagetml-edit .el-textarea__inner {\n  font-size: 12px;\n}\n.page-justsee-messagetml-edit .el-input--suffix .el-input__inner {\n  font-size: 12px;\n}\n.page-justsee-messagetml-edit .el-input__inner {\n  font-size: 12px;\n}\n.page-justsee-message-channel .temp-content .el-textarea.is-disabled .el-textarea__inner {\n  border: 1px solid #bcbcbc;\n}\n.page-justsee-message-channel .just-see-checkbox span {\n  margin-right: 6px;\n}\n.page-justsee-message-channel .el-date-editor.is-disabled .el-icon-date {\n  display: none;\n}\n.page-justsee-message-channel .el-textarea.is-disabled .el-textarea__inner {\n  border-color: transparent;\n  background-color: transparent;\n  cursor: text;\n  color: #808080;\n  border: 0 none;\n  padding-top: 10px;\n}\n.page-justsee-message-channel .el-checkbox {\n  margin-left: 0;\n  margin-right: 30px;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner {\n  border-color: transparent;\n  background-color: transparent;\n  cursor: text;\n  color: #808080;\n  padding: 0;\n  border: 0 none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:link {\n    border: none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:visited {\n    border: none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:hover {\n    border: none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:active {\n    border: none;\n}\n.page-justsee-message-channel .normal-text {\n  color: #808080;\n  padding: 0;\n}\n.page-justsee-message-channel .el-input__suffix {\n  display: none;\n}\n.page-justsee-message-channel .el-form-item__content {\n  color: #808080;\n}\n","",{version:3,sources:["G:/Workspaces/open/vue-module/base/src/views/sysMange/messageTemplate/edit.vue"],names:[],mappings:";AACA;EACE,gBAAgB;CACjB;AACD;EACE,aAAa;CACd;AACD;EACE,gBAAgB;EAChB,kBAAkB;CACnB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,0BAA0B;CAC3B;AACD;EACE,kBAAkB;CACnB;AACD;EACE,cAAc;CACf;AACD;EACE,0BAA0B;EAC1B,8BAA8B;EAC9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,kBAAkB;CACnB;AACD;EACE,eAAe;EACf,mBAAmB;CACpB;AACD;EACE,0BAA0B;EAC1B,8BAA8B;EAC9B,aAAa;EACb,eAAe;EACf,WAAW;EACX,eAAe;CAChB;AACD;IACI,aAAa;CAChB;AACD;IACI,aAAa;CAChB;AACD;IACI,aAAa;CAChB;AACD;IACI,aAAa;CAChB;AACD;EACE,eAAe;EACf,WAAW;CACZ;AACD;EACE,cAAc;CACf;AACD;EACE,eAAe;CAChB",file:"edit.vue",sourcesContent:["\n.page-justsee-messagetml-edit .marginTop8 {\n  margin-top: 8px;\n}\n.page-justsee-messagetml-edit .width490 {\n  width: 490px;\n}\n.page-justsee-messagetml-edit .el-form-item__label {\n  font-size: 12px;\n  line-height: 40px;\n}\n.page-justsee-messagetml-edit .el-textarea__inner {\n  font-size: 12px;\n}\n.page-justsee-messagetml-edit .el-input--suffix .el-input__inner {\n  font-size: 12px;\n}\n.page-justsee-messagetml-edit .el-input__inner {\n  font-size: 12px;\n}\n.page-justsee-message-channel .temp-content .el-textarea.is-disabled .el-textarea__inner {\n  border: 1px solid #bcbcbc;\n}\n.page-justsee-message-channel .just-see-checkbox span {\n  margin-right: 6px;\n}\n.page-justsee-message-channel .el-date-editor.is-disabled .el-icon-date {\n  display: none;\n}\n.page-justsee-message-channel .el-textarea.is-disabled .el-textarea__inner {\n  border-color: transparent;\n  background-color: transparent;\n  cursor: text;\n  color: #808080;\n  border: 0 none;\n  padding-top: 10px;\n}\n.page-justsee-message-channel .el-checkbox {\n  margin-left: 0;\n  margin-right: 30px;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner {\n  border-color: transparent;\n  background-color: transparent;\n  cursor: text;\n  color: #808080;\n  padding: 0;\n  border: 0 none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:link {\n    border: none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:visited {\n    border: none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:hover {\n    border: none;\n}\n.page-justsee-message-channel .el-input.is-disabled .el-input__inner:active {\n    border: none;\n}\n.page-justsee-message-channel .normal-text {\n  color: #808080;\n  padding: 0;\n}\n.page-justsee-message-channel .el-input__suffix {\n  display: none;\n}\n.page-justsee-message-channel .el-form-item__content {\n  color: #808080;\n}\n"],sourceRoot:""}])},453:function(e,n,t){var a=t(454);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t(167)("55490b50",a,!0,{})},454:function(e,n,t){n=e.exports=t(166)(!0),n.push([e.i,"\n.film-base-page .el-row[data-v-72a630a6]:last-child {\n  margin-bottom: 0;\n}\n.film-base-page .el-form-item.margin-bottom0[data-v-72a630a6] {\n  margin-bottom: 0;\n}\n.film-base-page .el-form-item[data-v-72a630a6] {\n  margin-bottom: 12px;\n}\n.film-base-page .el-col[data-v-72a630a6] {\n  border-radius: 4px;\n}\n.film-base-page .bg-purple-dark[data-v-72a630a6] {\n  background: #99a9bf;\n}\n.film-base-page .bg-purple[data-v-72a630a6] {\n  background: #d3dce6;\n}\n.film-base-page .bg-purple-light[data-v-72a630a6] {\n  background: #e5e9f2;\n}\n.film-base-page .grid-content[data-v-72a630a6] {\n  border-radius: 4px;\n  min-height: 36px;\n}\n.film-base-page .row-bg[data-v-72a630a6] {\n  padding: 10px 0;\n  background-color: #f9fafc;\n}\n.film-base-page .el-table .cell span.table-btn-mini[data-v-72a630a6] {\n  color: #3b74ff;\n  cursor: pointer;\n  margin-right: 6px;\n}\n.film-base-page .scene-btn[data-v-72a630a6] {\n  color: #3b74ff;\n  border: 1px solid #3b74ff;\n  border-radius: 4px;\n  padding-left: 12px;\n  padding-right: 12px;\n  margin-bottom: 6px;\n  margin-top: 6px;\n  height: 28px;\n  line-height: 28px;\n  cursor: pointer;\n}\n.template-box .left[data-v-72a630a6] {\n  float: left;\n}\n.template-box .right[data-v-72a630a6] {\n  float: right;\n}\n.template-demo-text[data-v-72a630a6] {\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  padding-bottom: 8px;\n  min-height: 32px;\n}\n.scene-btn[data-v-72a630a6] {\n  float: left;\n  margin-right: 6px;\n}\n","",{version:3,sources:["G:/Workspaces/open/vue-module/base/src/views/sysMange/messageTemplate/edit.vue"],names:[],mappings:";AACA;EACE,iBAAiB;CAClB;AACD;EACE,iBAAiB;CAClB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,oBAAoB;CACrB;AACD;EACE,mBAAmB;EACnB,iBAAiB;CAClB;AACD;EACE,gBAAgB;EAChB,0BAA0B;CAC3B;AACD;EACE,eAAe;EACf,gBAAgB;EAChB,kBAAkB;CACnB;AACD;EACE,eAAe;EACf,0BAA0B;EAC1B,mBAAmB;EACnB,mBAAmB;EACnB,oBAAoB;EACpB,mBAAmB;EACnB,gBAAgB;EAChB,aAAa;EACb,kBAAkB;EAClB,gBAAgB;CACjB;AACD;EACE,YAAY;CACb;AACD;EACE,aAAa;CACd;AACD;EACE,uBAAuB;EACvB,mBAAmB;EACnB,oBAAoB;EACpB,iBAAiB;CAClB;AACD;EACE,YAAY;EACZ,kBAAkB;CACnB",file:"edit.vue",sourcesContent:["\n.film-base-page .el-row[data-v-72a630a6]:last-child {\n  margin-bottom: 0;\n}\n.film-base-page .el-form-item.margin-bottom0[data-v-72a630a6] {\n  margin-bottom: 0;\n}\n.film-base-page .el-form-item[data-v-72a630a6] {\n  margin-bottom: 12px;\n}\n.film-base-page .el-col[data-v-72a630a6] {\n  border-radius: 4px;\n}\n.film-base-page .bg-purple-dark[data-v-72a630a6] {\n  background: #99a9bf;\n}\n.film-base-page .bg-purple[data-v-72a630a6] {\n  background: #d3dce6;\n}\n.film-base-page .bg-purple-light[data-v-72a630a6] {\n  background: #e5e9f2;\n}\n.film-base-page .grid-content[data-v-72a630a6] {\n  border-radius: 4px;\n  min-height: 36px;\n}\n.film-base-page .row-bg[data-v-72a630a6] {\n  padding: 10px 0;\n  background-color: #f9fafc;\n}\n.film-base-page .el-table .cell span.table-btn-mini[data-v-72a630a6] {\n  color: #3b74ff;\n  cursor: pointer;\n  margin-right: 6px;\n}\n.film-base-page .scene-btn[data-v-72a630a6] {\n  color: #3b74ff;\n  border: 1px solid #3b74ff;\n  border-radius: 4px;\n  padding-left: 12px;\n  padding-right: 12px;\n  margin-bottom: 6px;\n  margin-top: 6px;\n  height: 28px;\n  line-height: 28px;\n  cursor: pointer;\n}\n.template-box .left[data-v-72a630a6] {\n  float: left;\n}\n.template-box .right[data-v-72a630a6] {\n  float: right;\n}\n.template-demo-text[data-v-72a630a6] {\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  padding-bottom: 8px;\n  min-height: 32px;\n}\n.scene-btn[data-v-72a630a6] {\n  float: left;\n  margin-right: 6px;\n}\n"],sourceRoot:""}])},455:function(e,n,t){"use strict";var a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"page-wrapper page-justsee-message-channel page-justsee-messagetml-edit"},[t("div",{staticClass:"clearboth",staticStyle:{"margin-top":"30px"}}),e._v(" "),t("section",{staticClass:"film-base-page"},[t("el-form",{ref:"messageTemplate",attrs:{model:e.messageTemplate,rules:e.rules,"label-width":"110px","label-position":"right","label-height":"60px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"短信场景：",prop:"sceneCode"}},[t("el-select",{staticClass:"mini-select-size",staticStyle:{width:"360px"},attrs:{filterable:"",placeholder:"请选择",disabled:e.isJustSee},on:{change:e.templateFunc},model:{value:e.messageTemplate.sceneCode,callback:function(n){e.$set(e.messageTemplate,"sceneCode",n)},expression:"messageTemplate.sceneCode"}},e._l(e.sceneCodes,function(e){return t("el-option",{key:e.sceneCode,attrs:{label:e.sceneName,value:e.sceneCode}})}),1)],1)],1)],1),e._v(" "),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticStyle:{"margin-bottom":"8px"},attrs:{label:"场景变量：",prop:"seceneParam"}},e._l(e.messageTemplate.seceneParam,function(n){return t("div",{key:n.id,staticClass:"scene-btn",on:{click:function(t){return e.seceneParamFunc(n)}}},[e._v("\n              "+e._s(n.paramName)+"\n            ")])}),0)],1)],1),e._v(" "),t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"temp-content",attrs:{span:12}},[t("el-form-item",{attrs:{label:"模板内容：",prop:"content"}},[t("el-input",{staticStyle:{width:"360px"},attrs:{type:"textarea",rows:"4",colos:"50",resize:"none",disabled:e.isJustSee,placeholder:"请选择短信场景"},on:{change:e.templateTextareaFunc,blur:e.templateTextareaFunc},model:{value:e.messageTemplate.content,callback:function(n){e.$set(e.messageTemplate,"content",n)},expression:"messageTemplate.content"}}),e._v(" "),t("div",{staticClass:"template-box"})],1)],1)],1),e._v(" "),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}})],1),e._v(" "),e._e(),e._v(" "),e.isJustSee?e._e():t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"width490",attrs:{span:12}},[t("el-form-item",{attrs:{label:"测试手机号：",prop:"description"}},[t("el-input",{staticStyle:{width:"360px"},model:{value:e.messageTemplate.phone,callback:function(n){e.$set(e.messageTemplate,"phone",n)},expression:"messageTemplate.phone"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"marginTop8"},[t("el-button",{staticStyle:{"margin-left":"12px",padding:"8px 8px"},attrs:{type:"primary"},on:{click:e.sendMessage}},[e._v("发送测试短信")])],1)])],1)],1),e._v(" "),t("div",{staticClass:"btn",staticStyle:{margin:"20px auto","text-align":"center"}},[e.isModify||e.isJustSee?e._e():t("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.submitForm("messageTemplate",!1)}}},[e._v("保存")]),e._v(" "),e.isModify&&!e.isJustSee?t("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.submitForm("messageTemplate",!0)}}},[e._v("保存")]):e._e(),e._v(" "),e.isJustSee?e._e():t("el-button",{on:{click:e.out}},[e._v("取消")]),e._v(" "),e.isJustSee?t("el-button",{on:{click:e.out}},[e._v("返回")]):e._e()],1)],1)])},s=[],r={render:a,staticRenderFns:s};n.a=r}});